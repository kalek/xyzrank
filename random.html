<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MTG Tier Guessing Game - Fixed</title>
    <style>
        :root {
            --bg: #0f111a;
            --card-shadow: 0 20px 50px rgba(0,0,0,0.8);
            --accent: #00d2ff;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg);
            color: white;
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            overflow: hidden;
        }

        .game-container {
            position: relative;
            text-align: center;
            max-width: 500px;
            width: 90%;
        }

        #card-image {
            width: 100%;
            max-width: 400px;
            border-radius: 4.75% / 3.5%;
            box-shadow: var(--card-shadow);
            background: #222;
            min-height: 560px;
            transition: opacity 0.3s;
        }

        .tier-overlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.95);
            padding: 20px 40px;
            border-radius: 15px;
            font-size: 5rem;
            font-weight: 900;
            color: var(--accent);
            opacity: 0;
            transition: opacity 0.2s ease;
            pointer-events: none;
            border: 4px solid var(--accent);
            z-index: 100;
        }

        .card-display { position: relative; cursor: help; }
        .card-display:hover .tier-overlay { opacity: 1; }

        .controls { margin-top: 30px; display: flex; gap: 20px; justify-content: center; }

        button {
            background: #1a1c2c;
            border: 2px solid #333;
            color: white;
            padding: 15px 30px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1.2rem;
            min-width: 160px;
        }

        button:hover { background: var(--accent); color: #000; border-color: var(--accent); }

        #card-name-display { margin-bottom: 10px; font-size: 1.4rem; font-weight: bold; color: var(--accent); }
        .status { font-size: 0.8rem; color: #555; margin-top: 10px; }
    </style>
</head>
<body>

    <div id="card-name-display">Inicjalizacja...</div>

    <div class="game-container">
        <div class="card-display">
            <img id="card-image" src="" alt="MTG Card">
            <div class="tier-overlay" id="tier-value">?</div>
        </div>

        <div class="controls">
            <button onclick="prevCard()">◀ Poprzednia</button>
            <button onclick="nextCard()">Następna ▶</button>
        </div>
        <div class="status" id="load-status"></div>
    </div>

    <script>
        // Dane Twojej listy (skrócone do logiki)
        const rawData = {
            "4.5": ["Spinerock Tyrant", "Ajani, Outland Chaperone", "Curious Colossus", "Eirdu, Carrier of Dawn // Isilu, Carrier of Twilight"],
            "4.0": ["Champions of the Shoal", "Loch Mare", "Sunderflock", "End-Blaze Epiphany", "Soul Immolation", "Bitterbloom Bearer", "Champion of the Weird", "Moonshadow", "Champion of the Clachan"],
            "3.5": ["Disruptor of Currents", "Flitterwing Nuisance", "Glen Elendra Guardian", "Lofty Dreams", "Oko, Lorwyn Liege // Oko, Shadowmoor Scion", "Sygg, Wanderwine Wisdom // Sygg, Wanderbrine Shield", "Sear", "Gloom Ripper", "Taster of Wares", "Adept Watershaper", "Brigid, Clachan’s Heart // Brigid, Doun’s Mind", "Kinbinding", "Pyrrhic Strike"],
            "3.0": ["Blossombind", "Glamer Gifter", "Harmonized Crescendo", "Mirrorform", "Rime Chill", "Rimekin Recluse", "Shinestriker", "Swat Away", "Temporal Cleansing", "Unwelcome Sprite", "Ashling, Rekindled // Ashling, Rimebound", "Boulder Dash", "Champion of the Path", "Cinder Strike", "Collective Inferno", "Explosive Prodigy", "Feed the Flames", "Giantfall", "Goliath Daydreamer", "Sizzling Changeling", "Blight Rot", "Bogslithers Embrace", "Creakwood Safewright", "Dawnhand Dissident", "Gnarlbark Elm", "Graveshifter", "Iron-Shield Elf", "Nameless Inversion", "Burdened Stoneback", "Encumbered Reejerey", "Kinscaer Sentry", "Liminal Hold", "Moonlit Lamenter", "Protective Response", "Rhys, the Evermore", "Slumbering Walker", "Spiral into Solitude", "Wanderbrine Trapper", "Winnowing"],
            "2.5": ["Glamermite", "Noggle the Mind", "Silvergill Mentor", "Unexpected Assistance", "Boldwyr Aggressor", "Elder Auntie", "Flamebraider", "Kulrath Zealot", "Scuzzback Scrounger", "Sourbread Auntie", "Squawkroaster", "Sting-Slinger", "Tweeze", "Boggart Mischief", "Dream Seizer", "Grub, Storied Matriarch // Grub, Notorious Auntie", "Gutsplitter Gang", "Mudbutton Cursetosser", "Nightmare Sower", "Requiting Hex", "Retched Wretch", "Scarblade Scout", "Shimmercreep", "Twilight Diviner", "Unbury", "Flock Impostor", "Thoughtweft Imbuer", "Wanderbrine Preacher"],
            "2.0": ["Aquitects Defenses", "Illusion Spinners", "Omni-Changeling", "Stratosoarer", "Summit Sentinel", "Thirst for Identity", "Wild Unraveling", "Boneclub Berserker", "Brambleback Brute", "Flamekin Gildweaver", "Goatnap", "Gristle Glutton", "Hexing Squelcher", "Kindle the Inner Flame", "Soulbright Seeker", "Warren Torchmaster", "Aunties Sentence", "Barbed Bloodletter", "Bloodline Bidding", "Boggart Prankster", "Dawnhand Eulogist", "Dose of Dawnglow", "Heirloom Auntie", "Goldmeadow Nomad", "Keep Out", "Kinsbaile Aspirant", "Morningtides Light", "Personify", "Reluctant Dounguard", "Shore Lurker", "Sun-Dappled Celebrant", "Timid Shieldbearer", "Tributary Vaulter"],
            "1.5": ["Glen Elendra’s Answer", "Gravelgill Scoundrel", "Kulrath Mystic", "Pestered Wellguard", "Run Away Together", "Silvergill Peddler", "Tanufel Rimespeaker", "Wanderwine Distracter", "Wanderwine Farewell", "Burning Curiosity", "Enraged Flamecaster", "Flame-Chain Mauler", "Impolite Entrance", "Lavaleaper", "Reckless Ransacking", "Bile-Vial Boggart", "Blighted Blackthorn", "Moonglove Extractor", "Perfect Intimidation", "Scarblades Malice", "Appeal to Eirdu", "Bark of Doran", "Clachan Festival", "Crib Swap", "Evershrikes Gift", "Gallant Fowlknight", "Kithkeeper", "Meanders Guide", "Riverguards Reflexes"],
            "SB": ["Rimefire Torque", "Spell Snare", "Lasting Tarfire", "Meek Attack", "Darkness Descends", "Mornsong Aria"]
        };

        let cardList = [];
        let currentIndex = 0;

        function init() {
            for (let tier in rawData) {
                rawData[tier].forEach(name => cardList.push({ name, tier }));
            }
            cardList.sort(() => Math.random() - 0.5);
            updateDisplay();
        }

        async function updateDisplay() {
            const card = cardList[currentIndex];
            const img = document.getElementById('card-image');
            const status = document.getElementById('load-status');
            
            document.getElementById('card-name-display').innerText = card.name;
            document.getElementById('tier-value').innerText = card.tier;
            
            img.style.opacity = "0.2";
            status.innerText = "Pobieranie z API...";

            // Czyścimy nazwę (np. "Karta // Druga" -> "Karta")
            const cleanName = card.name.split('//')[0].trim();

            try {
                const response = await fetch(`https://api.scryfall.com/cards/named?fuzzy=${encodeURIComponent(cleanName)}`);
                const data = await response.json();

                if (data.status === 404) {
                    img.src = "https://svgs.scryfall.io/errors/missing.svg";
                    status.innerText = "Nie znaleziono karty w bazie Scryfall.";
                } else {
                    const url = data.image_uris ? data.image_uris.normal : data.card_faces[0].image_uris.normal;
                    img.src = url;
                    img.onload = () => {
                        img.style.opacity = "1";
                        status.innerText = "";
                    };
                }
            } catch (err) {
                status.innerText = "Błąd połączenia z API.";
            }
        }

        function nextCard() { currentIndex = (currentIndex + 1) % cardList.length; updateDisplay(); }
        function prevCard() { currentIndex = (currentIndex - 1 + cardList.length) % cardList.length; updateDisplay(); }

        document.addEventListener('keydown', (e) => {
            if (e.key === "ArrowRight") nextCard();
            if (e.key === "ArrowLeft") prevCard();
        });

        init();
    </script>
</body>
</html>